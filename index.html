<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Priorities Survey</title>
    <!-- Load Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for better aesthetics */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Ensure number inputs show spinners */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
          opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <!-- CHANGED max-w-lg to max-w-2xl for more width -->
    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg w-full max-w-2xl">
        
        <!-- INTRODUCTORY SECTION - STYLED TO MATCH --><header class="mb-6 pb-4 border-b border-gray-200">
            <!-- Removed the "APW 2026 Growth & Strategy" title here --><p class="text-md font-semibold text-gray-700 mb-3">As you do this exercise, consider the following priorities:</p>
            <ul class="list-disc list-inside text-sm text-gray-700 ml-4 space-y-1">
                <li>Increase growth and profitability</li>
                <li>Happy and engaged staff</li>
                <li>Satisfied customers and community partners</li>
                <li>Strengthen the global community</li>
                <li>Facilitate transformative educational experiences</li>
                <li>Connect people, transform lives, cultivate personal development</li>
                <li>Operational efficiency</li>
                <li>Build excellence</li>
            </ul>
        </header>
        <!-- END INTRODUCTORY SECTION --><h1 class="text-2xl font-bold text-gray-800 mb-4 text-center">2026 Priority Allocation Survey</h1>
        
        <!-- Name Question - Now REQUIRED --><div class="mb-6">
            <label for="name-input" class="block text-md font-semibold text-gray-700 mb-2">
                What is your name? <span class="text-red-500">*</span>
            </label>
            <input type="text" id="name-input" name="name" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" placeholder="Jane Doe" required>
        </div>
        
        <!-- The Constant Sum Question --><div class="mb-6">
            <label class="block text-md font-semibold text-gray-700 mb-3">
                100 points represents the total resources available (funding, hours, tools, etc.) for 2026. How would you allocate these points among the following categories?
            </label>
            <p class="text-sm text-gray-500 mb-4">NOTE: this point allocation should reflect what within APW merits our strategic focus and allocation of resources at this point in time, not what is theoretically important or is valuable for our/an organization. For example, if you think that staff engagement and development is of high value to our organization but it is well developed and currently does not require much strategic focus/prioritization, this item would receive a lower point allocation.</p>
            
            <div id="survey-form" class="space-y-4">
                
                <!-- Priority 1: Networking & relationship building - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="networking" class="text-gray-700 w-3/4">Networking & relationship building</label>
                    <input type="number" id="networking" name="networking" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <!-- Priority 2: Marketing & awareness - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="marketing" class="text-gray-700 w-3/4">Marketing & awareness</label>
                    <input type="number" id="marketing" name="marketing" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <!-- Priority 3: Maintaining city infrastructure - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="infrastructure" class="text-gray-700 w-3/4">Maintaining city infrastructure</label>
                    <input type="number" id="infrastructure" name="infrastructure" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <!-- Priority 4: In-person course offerings - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="in_person_courses" class="text-gray-700 w-3/4">In-person course offerings</label>
                    <input type="number" id="in_person_courses" name="in_person_courses" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <!-- Priority 5: Staff engagement & development - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="staff_engagement" class="text-gray-700 w-3/4">Staff engagement & development</label>
                    <input type="number" id="staff_engagement" name="staff_engagement" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <!-- Priority 6: Additional revenue streams - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="revenue_streams" class="text-gray-700 w-3/4">Additional revenue streams</label>
                    <input type="number" id="revenue_streams" name="revenue_streams" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>

                <!-- Priority 7: Online course offerings - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="online_courses" class="text-gray-700 w-3/4">Online course offerings</label>
                    <input type="number" id="online_courses" name="online_courses" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>

                <!-- Priority 8: Operational efficiencies - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="operational_efficiencies" class="text-gray-700 w-3/4">Operational efficiencies</label>
                    <input type="number" id="operational_efficiencies" name="operational_efficiencies" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>

                <!-- Priority 9: Welcome tour - WIDTHS ADJUSTED --><div class="flex items-center justify-between space-x-4">
                    <label for="welcome_tour" class="text-gray-700 w-3/4">Welcome tour</label>
                    <input type="number" id="welcome_tour" name="welcome_tour" min="0" max="100" value="0" class="survey-input w-1/4 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
        </div>
        
        <!-- Validation and Total Display --><div class="mb-6 p-4 bg-gray-50 rounded-lg">
            <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-gray-800">Total Points:</span>
                <span id="total-points" class="text-lg font-bold text-gray-800">0</span>
            </div>
            <div id="validation-message" class="text-center mt-2 text-sm font-medium"></div>
        </div>
        
        <!-- Submit Button --><button id="submit-btn" type="button" class="w-full bg-blue-600 text-white py-3 px-4 rounded-md font-semibold shadow-md transition-all duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" disabled>
            Submit
        </button>

        <!-- Success Message - TEXT UPDATED --><div id="success-message" class="hidden mt-4 p-4 bg-green-100 text-green-700 border border-green-300 rounded-md text-center">
            Thank you!
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = document.querySelectorAll('.survey-input');
            const nameInput = document.getElementById('name-input');
            const totalPointsEl = document.getElementById('total-points');
            const validationMessageEl = document.getElementById('validation-message');
            const submitBtn = document.getElementById('submit-btn');
            const successMessage = document.getElementById('success-message');
            const surveyForm = document.getElementById('survey-form');

            const validateAllInputs = () => {
                // 1. Calculate Constant Sum Total
                let total = 0;
                inputs.forEach(input => {
                    // Ensure we treat empty strings as 0
                    const value = parseInt(input.value, 10) || 0;
                    // Ensure non-negative values
                    if (value < 0) {
                        input.value = 0;
                    }
                    total += value;
                });

                totalPointsEl.textContent = total;

                // 2. Check Name Requirement
                const isNameValid = nameInput.value.trim().length > 0;
                const isSumValid = total === 100;

                // 3. Update Constant Sum Validation Message (and color total)
                if (isSumValid) {
                    validationMessageEl.textContent = 'Total is exactly 100!';
                    validationMessageEl.className = 'text-center mt-2 text-sm font-medium text-green-600';
                    totalPointsEl.className = 'text-lg font-bold text-green-600';
                } else if (total > 100) {
                    validationMessageEl.textContent = `Total is ${total}. Please reduce by ${total - 100}.`;
                    validationMessageEl.className = 'text-center mt-2 text-sm font-medium text-red-600';
                    totalPointsEl.className = 'text-lg font-bold text-red-600';
                } else {
                    validationMessageEl.textContent = `Total is ${total}. Please add ${100 - total} more.`;
                    validationMessageEl.className = 'text-center mt-2 text-sm font-medium text-yellow-600';
                    totalPointsEl.className = 'text-lg font-bold text-yellow-600';
                }

                // 4. Update Submit Button state
                if (isNameValid && isSumValid) {
                    submitBtn.disabled = false;
                } else {
                    submitBtn.disabled = true;
                    // If the sum is correct but the name is missing, override the message to prompt for name
                    if (isSumValid && !isNameValid) {
                        validationMessageEl.textContent = 'Please enter your name to submit.';
                        validationMessageEl.className = 'text-center mt-2 text-sm font-medium text-red-600';
                    }
                }
            };

            // Add event listeners to trigger validation on any input change
            inputs.forEach(input => {
                input.addEventListener('input', validateAllInputs);
            });
            nameInput.addEventListener('input', validateAllInputs); // Listen to name input too!
            
            // Handle form submission
            submitBtn.addEventListener('click', () => {
                // *** 1. PASTE YOUR GOOGLE SCRIPT URL HERE ***
                const scriptURL = 'https://script.google.com/macros/s/AKfycbyjKsKXMIACjbHc5Mql_z1RnAXW1qnadueLQtXg2RAAx1Y_wGgsISavutYKCVlmITBy/exec';

                // Get the name value
                const name = nameInput.value.trim() || 'Not provided';
                
                // Construct the data object
                const formData = {
                    name: name
                };
                inputs.forEach(input => {
                    formData[input.name] = parseInt(input.value, 10) || 0;
                });
                
                // Disable button and show "Submitting..."
                submitBtn.disabled = true;
                submitBtn.textContent = 'Submitting...';

                // Send data to Google Apps Script
                fetch(scriptURL, {
                    method: 'POST',
                    mode: 'cors', // 'cors' is needed for cross-domain requests
                    headers: {
                        // Apps Script web apps often prefer text/plain
                        'Content-Type': 'text/plain;charset=utf-8', 
                    },
                    body: JSON.stringify(formData)
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    // Hide the form and button, show success
                    document.querySelector('header').classList.add('hidden'); // Hide introductory header
                    document.querySelector('h1').classList.add('hidden'); // Hide main title
                    nameInput.parentElement.classList.add('hidden'); // Hide name question div
                    
                    // Hides the entire constant sum question block (instructions and inputs)
                    surveyForm.parentElement.classList.add('hidden'); 

                    submitBtn.classList.add('hidden');
                    validationMessageEl.classList.add('hidden');
                    document.querySelector('.bg-gray-50').classList.add('hidden'); // Hide total box
                    
                    successMessage.classList.remove('hidden');
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    // Show an error to the user
                    validationMessageEl.textContent = 'Error: Could not submit. Please check your script URL and connection.';
                    validationMessageEl.className = 'text-center mt-2 text-sm font-medium text-red-600';
                    
                    // Re-enable the button
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit';
                });
            });

            // Initial check on load
            validateAllInputs();
        });
    </script>

</body>
</html>
